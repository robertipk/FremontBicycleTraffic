<!DOCTYPE html>
<html>
<head>
  <title>Nordstrom Internship Homework</title>
</head>
<body>


</body>
</html>


          <body>
          <h1 class="text-center">Nordstrom Internship Homework</h1>
          <h5 class="text-center">Robert Ip<span class="glyphicon glyphicon-user"></span></h5>
          <div class="dropdown">
              <button class="btn btn-primary dropdown-toggle text-center" type="button" data-toggle="dropdown">Technologies and Languages
              <span class="caret"></span></button>
              <ul class="dropdown-menu">
                <li>HTML</li>
                <li>CSS</li>
                <li>JavaScript</li>
                <li>Ruby on Rails</li>
                <li>Java</li>
                <li>C++</li>
              </ul>
          </div>
          </br>
          <div class = "panel panel-info">
            <div class = "panel-heading">
          <h2> Technologies used </h2>
          <p>Ruby on Rails </p>
          <p>Highcharts </p>

            </div>
          </div>

          <div class = "panel panel-info">
            <div class = "panel-heading">
          <h2> Dataset </h2>
          <p>As an avid runner and biker, when I last stayed in Seattle I frequently ran over the Fremont Bridge to get to Gas Works Park. In this Rails app, I use the <a href="https://data.seattle.gov/Transportation/Fremont-Bridge-Hourly-Bicycle-Counts-by-Month-Octo/65db-xm6k"><strong>Fremont Bridge Bicycle Counter dataset</strong></a> to show trends in bicycle traffic over the Fremont Bridge. </p>
          <p>I used the <a href="https:github.com/socrata/soda-ruby"><strong>soda-ruby</strong></a> gem to pull data from the Socrata Seattle Open Data API.</p>
          <p>Socrata APIs may be accessed using the Socrata Query Language (SoQL) which borrows heavily from SQL. Requests are made to this REST API through HTTPS. Response types include JSON, XML, and CSV.</p>
          <p> The Bicycle Counter dataset table has three columns:</p> 
            </div>
          </div>

          <div class = "panel panel-info">
            <div class = "panel-heading">
          <img src="<%= asset_path( 'databasepic.png' ) %>" />
            </div>
          </div>

           <div class = "panel panel-info">
            <div class = "panel-heading">
          <p>As a result, I created my Tally table in my postgres database with the following migration:</p> 
            </div>
          </div>
          <pre class="prettyprint">
            rails generate migration model Tally date:string fremont_bridge_nb:string fremont_bridge_sb:string
          </pre> 


          <div class = "panel panel-info">
            <div class = "panel-heading">
          <h4>The  controller below</h4>
            <ol type="1">
              <ul>1. Instantiates client </ul>
              <ul>2. Sends a GET request to endpoint for rows with timestamps between 1/1/2014 and 1/02/2014, then stores the results in response</ul>
              <ul>3. Iterates over each object in the hash. If the object does not exist in the Tally table, a new entry is created with the corresponding values and saved in the table</ul>
              <ul>4. @data, which contains all entires in the Tally table, is sent to rawjson.html.erb
            </ol>
            </div>
          </div>

          <pre class="prettyprint">
            def rawjson
                client = SODA::Client.new({:domain => "data.seattle.gov/",
                                         :app_token => "AU94c3BhpwNnRY8ExL34d2W4x"})
                response = client.get("4xy5-26gy", {"$where" => "date > '2014-01-01T12:00:00' AND date < '2015-01-02T18:00:00'"})

                response.each do |r|
                  record = Tally.find_or_create_by(date: r.date, fremont_bridge_nb: r.fremont_bridge_nb, fremont_bridge_sb: r.fremont_bridge_sb)
                  record.save
                end
                @data = Tally.all
            end
          </pre>  

          

          <div class = "panel panel-info">
            <div class = "panel-heading">
            <h2>Challenges </h2>
          <p>After watching Michael Bate's 2010 RailsCasts tutorial on integrating HighCharts into Rails and making a few HighCharts graphs with hard-coded data using pure javascript, I decided to use Miguel Martinez's <a href="https://github.com/michelson/lazy_high_charts"><strong>LazyHighCharts gem.</strong></a> </p>
            </div>
          </div>

          <div class = "panel panel-info">
            <div class = "panel-heading">
          <h2> Goals </h2>
            <p>It migh be interesting to compare this data with crash statistics/traffic accidents over the same time intervals</p>
            </div>
          </div>


<%= link_to "Click here for some beautiful charts", action: "chart" %>

